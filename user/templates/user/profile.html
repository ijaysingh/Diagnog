<!-- To show the profile of the customer - manage as well -->


{% block content %}
{% load static %}
{% load icon %}

<!doctype html>
<html class="no-js" lang="zxx">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>My Account | DiagnoG - Med eCommerce </title>
    <meta name="robots" content="noindex, follow" />
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="shortcut icon" href="{% static 'favicons/1.svg' %}" type="image/x-icon" />

    <style>
        .dropdown {
          position: relative;
          display: inline-block;
        }
        
        .dropdown-content {
          display: none;
          position: absolute;
          right: 0;
          background-color: #f9f9f9;
          width: 80px;
          box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
          z-index: 1;
        }
        
        .dropdown-content a {
          color: black;
          padding: 5px 5px;
          text-decoration: none;
          display: block;
        }
        
        .dropdown-content a:hover {background-color: #f1f1f1;}
        .dropdown:hover .dropdown-content {display: block;}
        </style>
    <!-- Place favicon.png in the root directory -->
    <link rel="shortcut icon" href="img/favicon.png" type="image/x-icon" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <!-- css files -->
    {% include 'include/css.html' %}

    <!-- js files -->
    {% include 'include/js.html' %}
</head>

<body>
    <!--[if lte IE 9]>
        <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
    <![endif]-->

    <!-- Add your site or application content here -->

<!-- Body main wrapper start -->
<div class="body-wrapper">

    <!-- HEADER AREA START (header-3) -->
    {% include 'header/header.html' %}
    <!-- HEADER AREA END -->

    <!-- MOBILE MENU START -->
    <!-- MOBILE MENU END -->

    <!-- Utilize Cart Menu Start -->
    {% include 'widget/cart_menu.html' %}
    <!-- Utilize Cart Menu End -->

    <!-- Utilize Mobile Menu Start -->
    {% include 'header/mobile_menu.html' %}
    <!-- Utilize Mobile Menu End -->

    <div class="ltn__utilize-overlay"></div> <br> <br>

    <!-- BREADCRUMB AREA START -->
    <div class="ltn__breadcrumb-area text-left bg-overlay-white-30 bg-image "  data-bs-bg="img/bg/14.jpg">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="ltn__breadcrumb-inner">
                        <h1 class="page-title">My Account</h1>
                        <div class="ltn__breadcrumb-list">
                            <ul>
                                <li><a href="/"><span class="ltn__secondary-color"><i class="fas fa-home"></i></span> Home</a></li>
                                <li>My Account</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- BREADCRUMB AREA END -->

    <!-- WISHLIST AREA START -->
    <div class="liton__wishlist-area pb-70">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <!-- PRODUCT TAB AREA START -->
                    <div class="ltn__product-tab-area">
                        <div class="container">
                            <div class="row">
                                <div class="col-lg-4">
                                    <div class="ltn__tab-menu-list mb-50">
                                        <div class="nav">
                                            <a class="active show" data-bs-toggle="tab" href="#liton_tab_1_1">Dashboard <i class="fas fa-home"></i></a>
                                            <a data-bs-toggle="tab" href="#liton_tab_1_2">Orders <i class="fas fa-file-alt"></i></a>
                                            <a data-bs-toggle="tab" href="#liton_tab_1_3">address <i class="fas fa-map-marker-alt"></i></a>
                                            <a data-bs-toggle="tab" href="#liton_tab_1_4">Account Details <i class="fas fa-user"></i></a>
                                            <a href="{% url 'logout' %}">Logout <i class="fas fa-sign-out-alt"></i></a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-8">
                                    <div class="tab-content">
                                        <div class="tab-pane fade active show" id="liton_tab_1_1">
                                            <div class="ltn__myaccount-tab-content-inner">
                                                <p>Hello <strong>{{ user }}</strong> (not <strong>{{ user }}</strong>? <small><a href="{% url 'logout' %}">Log out</a></small> )</p>
                                                <p>From your account dashboard you can view your <span>recent orders</span>, manage your <span>shipping and billing addresses</span>, and <span>edit your password and account details</span>.</p>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="liton_tab_1_2">
                                            <div class="ltn__myaccount-tab-content-inner">
                                                <div class="table-responsive">
                                                    <table class="table">
                                                        <thead>
                                                            <tr>
                                                                <th>Order</th>
                                                                <th>Date</th>
                                                                <th>Status</th>
                                                                <th>Total</th>
                                                                <th>Action</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            {% for order in orders %}
                                                            <tr>
                                                                <td>{{ loop.index }}</td>
                                                                <td>{{ order.date_ordered }}</td>
                                                                <td> {% if order.complete %}Completed {% else %}Pending {% endif %}</td>
                                                                <td>â‚¹{{ order.get_cart_total }}</td>
                                                                <td><a href="cart.html">View</a></td>
                                                            </tr>
                                                            {% endfor %}
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="liton_tab_1_3">
                                            <div class="ltn__myaccount-tab-content-inner update">
                                                <div class="ltn__checkout-single-content-info" id="post-refresh-address">
                                                    <div class="ltn__checkout-single-content ltn__coupon-code-wrap">
                                                        <h5><a class="ltn__secondary-color hide-address" href="#ltn__address-form" data-bs-toggle="collapse">+ Click to add new address</a></h5>
                                                        <div id="ltn__address-form" class="collapse ltn__checkout-single-content-info">
                                                            <div class="ltn__address-form">
                                                                <h4 class="title-2">Billing Details</h4>
                                                                <div class="ltn__checkout-single-content-info">
                                                                    <div class="row">
                                                                    <form action="{% url 'addAddress' %}" method="POST" id="addressform">
                                                                    {% csrf_token %}
                                                                    <h6>Personal Information</h6>
                                                                    <div class="row">
                                                                        <div class="col-md-6">
                                                                            <div class="input-item input-item-name ltn__custom-icon">
                                                                                <input type="text" name="name" placeholder="First name">
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-6">
                                                                            <div class="input-item input-item-name ltn__custom-icon">
                                                                                <input type="text" name="lastname" placeholder="Last name">
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-6">
                                                                            <div class="input-item input-item-email ltn__custom-icon">
                                                                                <input type="email" name="email" placeholder="email address">
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-6">
                                                                            <div class="input-item input-item-phone ltn__custom-icon">
                                                                                <input type="text" name="phone" placeholder="phone number">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="row">
                                                                        <div class="col-lg-12 col-md-12">
                                                                            <h6>Address</h6>
                                                                            <div class="row">
                                                                                <div class="col-md-6">
                                                                                    <div class="input-item">
                                                                                        <input type="text" name="street" placeholder="House number and street name">
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-md-6">
                                                                                    <div class="input-item">
                                                                                        <input type="text" name="apartment" placeholder="Apartment, suite, unit etc. (optional)">
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-lg-4 col-md-6">
                                                                            <h6>Town / City</h6>
                                                                            <div class="input-item">
                                                                                <input type="text" name="city" placeholder="City">
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-lg-4 col-md-6">
                                                                            <h6>State </h6>
                                                                            <div class="input-item">
                                                                                <input type="text" name="state" placeholder="State">
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-lg-4 col-md-6">
                                                                            <h6>Zip</h6>
                                                                            <div class="input-item">
                                                                                <input type="text" name="zip" placeholder="Zip">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    {% comment %} <p><label class="input-info-save mb-0"><input type="checkbox" name="agree"> Create an account?</label></p>
                                                                    <h6>Order Notes (optional)</h6>
                                                                    <div class="input-item input-item-textarea ltn__custom-icon">
                                                                        <textarea name="ltn__message" placeholder="Notes about your order, e.g. special notes for delivery."></textarea>
                                                                    </div> {% endcomment %}
                                                                    <button type="submit" class="submit-button-1" id="form-button"> Submit </button>
                                                                </form>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                                <div class="row">
                                                    {% for address in addresses %}
                                                    <div class="col-md-12 col-12 learts-mb-30 card" id="card-{{address.id}}">
                                                        <h4>{{address.first_name}} {{address.phone}}
                                                        <div class="dropdown" style="float:right;">
                                                            <a href="#" class="px-2" data-bs-toggle="dropdown">
                                                              <i>{% icon "more-vertical" %}</i>
                                                            </a>
                                                            <ul class="dropdown-menu dropdown-content dropdown-menu-end">
                                                              <li>
                                                                <button type='submit' data-id="{{ address.id }}" data-action="edit" class="dropdown-item">
                                                                    <div class="flex align-items-center">
                                                                      <i >{% icon "edit" %}</i>
                                                                        <span class="ms-2">Edit</span>
                                                                    </div>
                                                                </button>
                                                            </li>
                                                            <li>
                                                                <button type='submit' data-id="{{ address.id }}" data-action="remove" class="dropdown-item">
                                                                    <div class="d-flex align-items-center">
                                                                      <i >{% icon "delete" %}</i>
                                                                        <span class="ms-2">Delete</span>
                                                                    </div>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div></h4>
                                                        <address>
                                                            {{address.street_address}}, {{address.apartment_address}}<br>
                                                                {{address.city}}, {{address.state}} {{address.zip}}
                                                        </address>
                                                    </div>
                                                    <div class="card" id="address-{{address.id}}" hidden>
                                                        <form action="{% url 'updateAddress' id=address.id%}" method="POST">
                                                            {% csrf_token %}
                                                            <h6>Personal Information</h6>
                                                            <div class="row">
                                                                <div class="col-md-6">
                                                                    <div class="input-item input-item-name ltn__custom-icon">
                                                                        <input type="text" name="name" value={{ address.first_name }} placeholder="First name">
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-6">
                                                                    <div class="input-item input-item-name ltn__custom-icon">
                                                                        <input type="text" name="lastname" value={{ address.last_name }} placeholder="Last name">
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-6">
                                                                    <div class="input-item input-item-email ltn__custom-icon">
                                                                        <input type="email" name="email" value={{ address.email }} placeholder="email address">
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-6">
                                                                    <div class="input-item input-item-phone ltn__custom-icon">
                                                                        <input type="text" name="phone" value={{ address.phone }} placeholder="phone number">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-lg-12 col-md-12">
                                                                    <h6>Address</h6>
                                                                    <div class="row">
                                                                        <div class="col-md-6">
                                                                            <div class="input-item">
                                                                                <input type="text" name="street" value={{ address.street_address }} placeholder="House number and street name">
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-6">
                                                                            <div class="input-item">
                                                                                <input type="text" name="apartment" value={{ address.apartment_address }} placeholder="Apartment, suite, unit etc. (optional)">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-4 col-md-6">
                                                                    <h6>Town / City</h6>
                                                                    <div class="input-item">
                                                                        <input type="text" name="city" value={{ address.city }} placeholder="City">
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-4 col-md-6">
                                                                    <h6>State </h6>
                                                                    <div class="input-item">
                                                                        <input type="text" name="state" value={{ address.state }} placeholder="State">
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-4 col-md-6">
                                                                    <h6>Zip</h6>
                                                                    <div class="input-item">
                                                                        <input type="text" name="zip" value={{ address.zip }} placeholder="Zip">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <button type="submit" class="submit-button-1" id="form-button"> Submit </button>
                                                        </form>
                                                </div>
                                                    {% endfor %}
                                                </div>
                                            </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="liton_tab_1_4">
                                            <div class="ltn__myaccount-tab-content-inner">
                                                <div class="ltn__form-box">
                                                    <form action="{% url 'profileUpdate' %}" method="POST">
                                                        {% csrf_token %}
                                                        <div class="row mb-50">
                                                            <div class="col-md-6">
                                                                <label>First name:</label>
                                                                <input type="text" name="ltn__name" value="{{ user.first_name }}">
                                                            </div>
                                                            <div class="col-md-6">
                                                                <label>Last name:</label>
                                                                <input type="text" name="ltn__lastname" value="{{ user.last_name }}">
                                                            </div>
                                                            <div class="col-md-6">
                                                                <label>Display Name:</label>
                                                                <input type="text" name="ltn__username" value="{{ user }}">
                                                            </div>
                                                            <div class="col-md-6">
                                                                <label>Display Email:</label>
                                                                <input type="email" name="ltn__email" value="{{user.email}}">
                                                            </div>
                                                        </div>
                                                        {% comment %} <fieldset>
                                                            <legend>Password change</legend>
                                                            <div class="row">
                                                                <div class="col-md-12">
                                                                    <label>Current password (leave blank to leave unchanged):</label>
                                                                    <input type="password" name="ltn__name">
                                                                    <label>New password (leave blank to leave unchanged):</label>
                                                                    <input type="password" name="ltn__lastname">
                                                                    <label>Confirm new password:</label>
                                                                    <input type="password" name="ltn__lastname">
                                                                </div>
                                                            </div>
                                                        </fieldset> {% endcomment %}
                                                        <div class="btn-wrapper">
                                                            <button type="submit" class="btn theme-btn-1 btn-effect-1 text-uppercase">Save Changes</button>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- PRODUCT TAB AREA END -->
                </div>
            </div>
        </div>
    </div>
    <!-- WISHLIST AREA START -->

    <!-- CALL TO ACTION START (call-to-action-6) -->
    {% include 'widget/call_to_action.html' %}
    <!-- CALL TO ACTION END -->

    <!-- FOOTER AREA START -->
    {% include 'footer/footer.html' %}
    <!-- FOOTER AREA END -->
</div>
  
</body>
{% comment %} 
<script>
    $(document).on('click','.dropdown-item',function(){
        var id = $(this).data('id');
        $.ajax({
            url:'',
            type:'GET',
            data:{
                'id':id,
            },
            success:function(data){
                $('#liton_tab_1_3 .update').html($('#liton_tab_1_3 .update',data));
            },
            error:function(){
                console.log('error')
            },
        });
    }); {% endcomment %}


function updateAddress(id){
    console.log('clicked..')
    console.log(id)
    var element = document.getElementById("card-"+id);
    //var hidden = element.getAttribute("hidden");
    var form_data = document.getElementById('address-'+id);
    //form_data.removeAttribute("hidden");
    console.log(form_data);
    element.innerHTML = form_data.innerHTML;
    //if (hidden) {
    //    element.removeAttribute("hidden");
    //} else {
    //    element.setAttribute("hidden", "hidden");
    //}
}

    var buttons = document.getElementsByClassName('dropdown-item');
    for(var i=0; i<buttons.length; i++){
        buttons[i].addEventListener("click", function(){
            var addressId = $(this).data('id');
            var action = $(this).data('action');
            if (action =='edit'){
                updateAddress(addressId);
            }
            else{
                $.ajax({
                    url:"{% url 'profile' %}",
                    type: 'GET',
                    data: {
                        'addressId':addressId,
                        'action':action,
                    },
                    success:function(data){
                        $('#liton_tab_1_3 .update').html($('#liton_tab_1_3 .update',data));
                    },
                    error:function(){
                        console.log('error')
                    },
                });
            }
        })
    }
</script>
</html>



{% endblock %}